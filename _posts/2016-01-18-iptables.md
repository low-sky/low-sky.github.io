---
layout: post
title: Sysadmin by Google
---

I am not a sysadmin.  In fact, I'm every sysadmin's worst nightmare: I'm a power user that has access to `sudo`.  I run a few machines and when there are problems, I follow the [xkcd approach](https://xkcd.com/627/).  This leads to me copy-pasting in commands that I found over google, usually on stackexchange.  This is how science advances.  This post details my experience trying to run a multi-user OpenStack project here.  The basic issue is that we have one (1) public IP address for our VMs and many users and instances.  There are two possible approaches.  The nice route would be to just configure the virtual router on the openstack cloud to do this forwarding automagically.  Alternatively, we could make a routing VM where we can address this directly.  

## Managing the Virtual Router

I can't find a way to access this functionality without access to the underlying OpenStack interface, i.e., this seems supported but it's not a user-space option.  It does seem [possible and preferred](https://blueprints.launchpad.net/neutron/+spec/router-port-forwarding).  

## Creating a VM router

First, I created a new security group that allowed for custom TCP access on a range of ports.  Let's say it's 2201 to 2222.  It isn't, but that's good for now.

On the host VM, I edit `/etc/ssh/ssh_config` to inclue the lines
	
	Port 2201
	Port 2202
	...
	Port 2222

and I do the same thing in `/etc/ssh/sshd_config`.  I then restarted ssh: `service ssh restart`.

Now, I can ssh into the gateway VM on nonstandard ports.  Next up, I'll try to pick off these ports with an `iptables` and send them onto another VM.


